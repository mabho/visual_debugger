!function(e){e.behaviors.visualDebugger={body:document.body,constants:{baseZIndex:0},classNames:{classNameVisualDebugger:"visual-debugger",classNameInitialized:"visual-debugger--initialized",classNameBaseLayer:"visual-debugger--base",classNameInstanceLayer:"instance-element",classNameInstanceLayerUnchecked:"instance-element--unchecked",classNameInstanceLayerChecked:"instance-element--checked",classNameObjectType:"object-type",classNameIconActivated:"icon-checkbox-checked",classNameIconDectivated:"icon-checkbox-unchecked",classNameCheckboxToggle:"checkbox-toggle",classNameSpanToggle:"span-toggle",classNameActivated:"item-activated",classNameDeactivated:"item-deactivated",classNameObjectTypeTyped:e=>`object-type--${e}`},layerAttributes:{layerIdAttributeName:"data-vd-id",layerTargetIdAttributeName:"data-vd-target-id"},themeDebugNodes:null,triggerResizeObserver(e){const{body:t}=this,{layerIdAttributeName:s,layerTargetIdAttributeName:a}=this.layerAttributes,n=new ResizeObserver((e=>{e.forEach((e=>{const n=e.target,c=n.getAttribute(s),i=t.querySelector(`[${a}="${c}"]`);this.setInstanceLayerSizeAndPosition(i,n)}))}));e.forEach((e=>{const{instanceRefElement:t}=e;n.observe(t)}))},triggerMutationObserver:function(e){new MutationObserver((()=>{e.forEach((e=>{this.setInstanceLayerSizeAndPosition(e.instanceLayer,e.instanceRefElement)}))})).observe(this.body,{attributes:!0,attributeFilter:["style"]})},regExs:{regexGetTemplateDebug:()=>new RegExp("THEME DEBUG"),regexGetTemplateHook:()=>new RegExp("THEME HOOK: '([^']*)'"),regexGetTemplateSuggestions:()=>new RegExp("FILE NAME SUGGESTIONS:s*\ns*([^']*)s*\n*s*"),regexGetTemplateFilePath:()=>new RegExp("BEGIN OUTPUT from '([^']*)'"),regexGetTemplateEndOutput:()=>new RegExp("END OUTPUT from '([^']*)'")},controllerElement:null,getUniquePropertyHooks:e=>e.map((e=>e.instanceActiveElement.propertyHook)).filter(((e,t,s)=>s.indexOf(e)===t)).sort(),getCalculatedDomDepth(e){let t=0;for(;e.parentNode;)t++,e=e.parentNode;return t},generateBaseLayer(){const e=document.createElement("div"),{classNameVisualDebugger:t,classNameBaseLayer:s}=this.classNames;return e.classList.add(t),e.classList.add(s),e},getCheckedNodes(){return this.themeDebugNodes.filter((e=>e.instanceLayer.classList.contains(this.classNames.classNameInstanceLayerChecked)))},generateInstanceLayer(e,t,s){const a=document.createElement("div"),n=this.controllerElement,{layerTargetIdAttributeName:c}=this.layerAttributes,{classNameInstanceLayer:i,classNameInstanceLayerChecked:r,classNameInstanceLayerUnchecked:l,classNameObjectType:o,classNameObjectTypeTyped:d,classNameIconActivated:m,classNameIconDectivated:u,classNameCheckboxToggle:g,classNameSpanToggle:h,classNameActivated:p,classNameDeactivated:y}=this.classNames;a.classList.add(i,o,d(e.getObjectType()),l),a.setAttribute(c,s),a.style.zIndex=this.getCalculatedDomDepth(t),this.setInstanceLayerSizeAndPosition(a,t);const b=e,N=document.createElement("input");N.setAttribute("type","checkbox"),N.classList.add(g);const E=document.createElement("span");E.classList.add(h,p,m);const v=document.createElement("span");return v.classList.add(h,y,u),a.append(N,E,v),a.addEventListener("mouseenter",(()=>{N.focus({preventScroll:!0}),n.setActiveThemeElement(b)})),a.addEventListener("mouseleave",(()=>{N.blur(),n.resetActiveThemeElement(b)})),a.addEventListener("click",(()=>{this.getCheckedNodes().forEach((e=>{e.instanceLayer!==a&&e.instanceLayer.click()})),N.click()})),N.addEventListener("change",(()=>{a.classList.toggle(r),a.classList.toggle(l),!0===N.checked?(N.focus(),n.setDefaultThemeElement(e)):(N.blur(),n.resetDefaultThemeElement(e))})),a},setInstanceLayerSizeAndPosition(e,t){const s=t.getBoundingClientRect(),a=Math.round(s.top+window.scrollY),n=Math.round(s.left+window.scrollX);let{width:c,height:i}=s;i=Math.round(i),c=Math.round(c),e.style.width=`${Math.round(c)}px`,e.style.height=`${Math.round(i)}px`,e.style.top=`${a}px`,e.style.left=`${n}px`},attach:function(e,t){const{body:s}=this,{classNameInitialized:a}=this.classNames;s.classList.contains(a)||(s.classList.add(a),this.main(e,t,s))},main:function(t,s,a){const{regexGetTemplateDebug:n,regexGetTemplateHook:c,regexGetTemplateSuggestions:i,regexGetTemplateFilePath:r}=this.regExs,{layerIdAttributeName:l}=this.layerAttributes,o=e.controllerElement;this.controllerElement=o;const d=this.generateBaseLayer();a.appendChild(d);let m=[],u=e.themeElement;u.init();document.querySelectorAll("*").forEach((e=>{const t=e.childNodes;Array.from(t).forEach((e=>{if(e.nodeType!==Node.COMMENT_NODE)return;if(n().test(e.textContent))return void u.setActivated();if(null===u)return;const t=e.textContent.match(c());if(t)return u.setPropertyHook(t[1]),void u.setObjectType(t[1]);const s=e.textContent.match(i());if(s){const e=s[1].trim().split(/\n\s*/).map((e=>{const t=e.split(" ");return{suggestion:t[1],activated:"x"===t[0]}}));return void u.setSuggestions(e)}const a=e.textContent.match(r());if(a){u.setFilePath(a[1]);const t=e.nextElementSibling;if(t&&t.nodeType===Node.ELEMENT_NODE&&null===u.dataNode){u.setDataNode(t);const e=Object.assign({},u),s=`element-${Math.random().toString(36).substring(7)}`,a=this.generateInstanceLayer(e,t,s),n={instanceActiveElement:e,instanceLayer:a,instanceRefElement:t};t.setAttribute(l,s),m.push(n),d.appendChild(a)}u.reset()}}))})),console.warn(m),this.themeDebugNodes=m,this.triggerMutationObserver(m),this.triggerResizeObserver(m);let g=this.getUniquePropertyHooks(m);console.log(g),console.warn(o),o.init(d,m),a.appendChild(o.generateControllerLayer()),o.executePostActivation()},detach:function(e,t,s){}}}(Drupal);